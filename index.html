<html>
  <head>
    <title>Wenqi He | 何文琦 | 하문기</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="/style.css" rel="stylesheet">
    <script src="//cdn.jsdelivr.net/npm/lodash@4.17.15/lodash.min.js"></script>
  </head>
  <body>
    <div class='slideshow'>
      <div class="fullscreen">
        <img class="fullscreen filtered blurred" src="/images/respotify.png">
        <div class="description">
          <h1 href="https://portfolio-galmungral.herokuapp.com/respotify">
            Go to Page <i class="material-icons">open_in_new</i>
          </h1>
        </div>
      </div>
      <div class="fullscreen">
        <img class="fullscreen filtered blurred" src="/images/notube.png">
        <div class="description">
          <h1 href="https://portfolio-galmungral.herokuapp.com/notube">
            Go to Page <i class="material-icons">open_in_new</i>
          </h1>
        </div>
      </div>
      <div class="fullscreen">
        <img class="fullscreen filtered blurred" src="/images/web-repl.png">
        <div class="description">
          <h1 href="https://portfolio-galmungral.herokuapp.com/web-repl">
            Go to Page <i class="material-icons">open_in_new</i>
          </h1>
        </div>
      </div>
      <div class="fullscreen">
        <img class="fullscreen filtered blurred" src="/images/marta.png">
        <div class="description">
          <h1 href="https://portfolio-galmungral.herokuapp.com/marta">
            Go to Page <i class="material-icons">open_in_new</i>
          </h1>
        </div>
      </div>
    </div>
    <script>
      let index = 0;
      function scrollTo(i) {
        document.body.scrollLeft = i * window.innerWidth;
      }
      function snap() {
        let targetIndex = Math.round(document.body.scrollLeft / window.innerWidth);
        let targetLeft = targetIndex * window.innerWidth;
        if (Math.abs(document.body.scrollLeft - targetLeft) < 50) {
          document.body.scrollLeft = targetLeft;
          index = targetIndex;
        } else {
          let left = document.body.scrollLeft * 0.7 + targetLeft * 0.3;
          document.body.scrollLeft = left;
          window.requestAnimationFrame(snap);
        }
      }
      window.addEventListener('scroll', _.debounce(snap, 100));
      window.addEventListener('keydown', e => {
        switch(e.key) {
          case 'ArrowLeft':
            e.preventDefault();
            if (--index < 0) index = 0;
            document.body.scrollLeft = index * window.innerWidth;
            break;
          case 'ArrowRight':
            e.preventDefault();
            if (++index > 3) index = 3;
            document.body.scrollLeft = index * window.innerWidth;
            break;
          default:
        }
      })

      document.body.onload = function() {
        document.querySelectorAll('img.blurred').forEach(img => {
          let description = img.parentNode.querySelector('.description');
          
          let link = description.querySelector('h1');
          let url = link.getAttribute('href');
          link.addEventListener('click', () => window.open(url));

          img.classList.remove('blurred');
          description.classList.add('hidden');
          
          function showDescription() {
            img.classList.add('blurred');
            description.classList.remove('hidden')
            setTimeout(() => {
              img.classList.remove('blurred');
              description.classList.add('hidden');
            }, 3000);
          }

          img.parentNode.addEventListener('click', _.debounce(showDescription, 200)); 
        });
      }
    </script>
  </body>
</html>