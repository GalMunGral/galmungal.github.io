<html>
  <head>
    <title>Wenqi He | 何文琦 | 하문기</title>
    <style>
      body {
        margin: 0;
        padding: 0;
        /* scroll-behavior: smooth; */
        -ms-overflow-style: none;
      }
      body::-webkit-scrollbar {
        display: none;
      }
      .slideshow {
        display: flex;
        flex-direction: row;
        align-items: flex-start;
      }
      .fullscreen {
        width: 100vw;
        height: 100vh;
        overflow: scroll;
        position: relative;
        /* When placed inside a flex container */
        flex: 0 0 auto;
      }
      img.fullscreen {
        object-fit: cover;
      }
      .fullscreen::-webkit-scrollbar {
        display: none;
      }
      .filtered {
        transition: filter 0.2s, transform 0.2s;
      }
      .blurred {
        filter: blur(80px) opacity(0.9);

      }
      .description {
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        display: flex;
        justify-content: center;
        align-items: center;
         transition: opacity 0.2s;
        transition-delay: 0.05s;
      }
      .hidden {
        opacity: 0;
        pointer-events: none;
      }
    </style>
    <script src="//cdn.jsdelivr.net/npm/lodash@4.17.15/lodash.min.js"></script>
  </head>
  <body>
    <div class='slideshow'>
      <div class="fullscreen">
        <img class="fullscreen filtered blurred" src="/images/respotify.png">
        <div class="description">
          <a href="https://portfolio-galmungral.herokuapp.com/respotify">Go to Page</a>
        </div>
      </div>
      <div class="fullscreen">
        <img class="fullscreen filtered blurred" src="/images/notube.png">
        <div class="description">
          <a href="https://portfolio-galmungral.herokuapp.com/notube">Go to Page</a>
        </div>
      </div>
      <div class="fullscreen">
        <img class="fullscreen filtered blurred" src="/images/web-repl.png">
        <div class="description">
          <a href="https://portfolio-galmungral.herokuapp.com/web-repl">Go to Page</a>
        </div>
      </div>
      <div class="fullscreen">
        <img class="fullscreen filtered blurred" src="/images/marta.png">
        <div class="description">
          <a href="https://portfolio-galmungral.herokuapp.com/marta">Go to Page</a>
        </div>
      </div>
    </div>
    <script>
      let index = 0;
      function scrollTo(i) {
        document.body.scrollLeft = i * window.innerWidth;
      }
      function snap() {
        let targetIndex = Math.round(document.body.scrollLeft / window.innerWidth);
        let targetLeft = targetIndex * window.innerWidth;
        if (Math.abs(document.body.scrollLeft - targetLeft) < 50) {
          document.body.scrollLeft = targetLeft;
          index = targetIndex;
        } else {
          let left = document.body.scrollLeft * 0.7 + targetLeft * 0.3;
          document.body.scrollLeft = left;
          window.requestAnimationFrame(snap);
        }
      }
      window.addEventListener('scroll', _.debounce(snap, 100));
      window.addEventListener('keydown', e => {
        switch(e.key) {
          case 'ArrowLeft':
            e.preventDefault();
            if (--index < 0) index = 0;
            document.body.scrollLeft = index * window.innerWidth;
            break;
          case 'ArrowRight':
            e.preventDefault();
            if (++index > 3) index = 3;
            document.body.scrollLeft = index * window.innerWidth;
            break;
          default:
        }
      })

      document.body.onload = function() {
        document.querySelectorAll('img.blurred').forEach(img => {
          let description = img.parentNode.querySelector('.description');
          img.classList.remove('blurred');
          description.classList.add('hidden');
          
          img.parentNode.addEventListener('click', () => {
            img.classList.add('blurred');
            description.classList.remove('hidden')
            setTimeout(() => {
              img.classList.remove('blurred');
              description.classList.add('hidden');
            }, 600);
          });
        }) 
      }
    </script>
  </body>
</html>